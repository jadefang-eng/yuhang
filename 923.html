<!DOCTYPE html><html lang="zh-CN"><head><meta name="x-poe-datastore-behavior" content="local_only"><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>人员排班表 - 可编辑版</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            margin: 20px;
            background-color: #fafafa;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 25px;
            font-weight: normal;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        th, td {
            border: 1px solid #e0e0e0;
            padding: 10px 8px;
            text-align: center;
            white-space: nowrap;
            position: relative;
        }
        th {
            background-color: #f8f9fa;
            color: #333;
            font-weight: bold;
            font-size: 15px;
        }
        .name {
            background-color: #e8eaf6;
            color: #3f51b5;
            font-weight: bold;
            width: 70px;
            font-size: 15px;
            letter-spacing: 1px;
        }
        
        /* 可编辑单元格样式 */
        .editable {
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .editable:hover {
            background-color: #f0f9ff !important;
            box-shadow: inset 0 0 0 2px #3b82f6;
        }
        
        /* 编辑输入框样式 */
        .edit-input {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
            text-align: center;
            font-size: 14px;
            font-family: inherit;
            box-shadow: inset 0 0 0 2px #3b82f6;
            border-radius: 4px;
            outline: none;
            position: absolute;
            top: 0;
            left: 0;
            padding: 10px 8px;
            box-sizing: border-box;
            resize: none;
        }
        
        /* 简洁的班次颜色 */
        .门 { background-color: #e3f2fd; color: #1976d2; }
        .库 { background-color: #f5f5f5; color: #424242; }
        .静 { background-color: #e8eaf6; color: #5e35b1; }
        .病 { background-color: #fff3e0; color: #f57c00; }
        .机 { background-color: #f1f8e9; color: #689f38; }
        .门库混合 { background-color: #e3f2fd; color: #1976d2; }
        .休 { background-color: #fef3c7; color: #d97706; }
        .换 { background-color: #f3e8ff; color: #7c3aed; }
        
        /* 预约休息行样式 */
        .rest-row {
            background-color: #f9f9f9;
            border-top: 2px solid #ddd;
        }
        .rest-label {
            background-color: #f0f0f0;
            color: #666;
            font-weight: bold;
            font-size: 13px;
            font-style: italic;
        }
        
        /* 确认对话框样式 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            text-align: center;
            min-width: 300px;
        }
        .modal-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }
        .modal-message {
            font-size: 14px;
            margin-bottom: 25px;
            color: #666;
            line-height: 1.4;
        }
        .modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-family: inherit;
            transition: background-color 0.3s;
        }
        .btn-primary {
            background-color: #4CAF50;
            color: white;
        }
        .btn-primary:hover {
            background-color: #45a049;
        }
        .btn-secondary {
            background-color: #f44336;
            color: white;
        }
        .btn-secondary:hover {
            background-color: #da190b;
        }
        
        /* 提示信息 */
        .tip {
            text-align: center;
            color: #666;
            font-size: 12px;
            margin-top: 15px;
            font-style: italic;
        }
        
        @media (max-width: 768px) {
            .container { padding: 15px; margin: 10px; }
            th, td { padding: 8px 6px; font-size: 13px; }
            .name { font-size: 14px; }
            .edit-input { font-size: 13px; padding: 8px 6px; }
            .modal-content { 
                min-width: 280px; 
                padding: 20px; 
                margin: 20px;
            }
            .modal-buttons { 
                flex-direction: column; 
                gap: 10px;
            }
        }
    </style>
<script src="https://puc.poecdn.net/authenticated_preview_page/syncedState.bd4eeeb8e8e02052ee92.js"></script></head>
<body>
    <div class="container">
        <h1>人员排班表 - 可编辑版</h1>
        
        <table id="scheduleTable">
            <tbody><tr>
                <th>人员</th>
                <th>9.23</th>
                <th>9.24</th>
                <th>9.25</th>
                <th>9.26</th>
                <th>周末</th>
            </tr>
            <tr>
                <td class="name">倪</td>
                <td class="门 editable">门</td>
                <td class="门 editable">门上/门</td>
                <td class="门 editable">门拖</td>
                <td class="门 editable">门中</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">丽</td>
                <td class="门 editable">门中</td>
                <td class="门 editable">门</td>
                <td class="门 editable">门/门下</td>
                <td class="门 editable">门拖</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">方</td>
                <td class="门 editable">门拖</td>
                <td class="门 editable">门中</td>
                <td class="门 editable">门</td>
                <td class="门 editable">门上/门</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">妍</td>
                <td class="门 editable">门/门下</td>
                <td class="门 editable">门拖</td>
                <td class="门 editable">门中</td>
                <td class="门 editable">门</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">秦</td>
                <td class="门库混合 editable">门上/库</td>
                <td class="门库混合 editable">库/门下</td>
                <td class="门库混合 editable">门上/库</td>
                <td class="门库混合 editable">库/门下</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">庆</td>
                <td class="库 editable">库</td>
                <td class="库 editable">库 08:30-10:00</td>
                <td class="库 editable">库 13:30-15:00</td>
                <td class="库 editable">库</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">瑾</td>
                <td class="机 editable">机（静）</td>
                <td class="静 editable">静 13:30-15:00</td>
                <td class="静 editable">静</td>
                <td class="静 editable">静 08:30-10:00</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">全</td>
                <td class="静 editable">静</td>
                <td class="机 editable">机（静）</td>
                <td class="静 editable">静 10:00-11:30</td>
                <td class="静 editable">静</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">荣</td>
                <td class="静 editable">静 08:30-10:00</td>
                <td class="静 editable">静</td>
                <td class="机 editable">机（静）</td>
                <td class="静 editable">静 10:00-11:30</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">斯</td>
                <td class="静 editable">静 10:00-11:30</td>
                <td class="静 editable">静</td>
                <td class="静 editable">静</td>
                <td class="机 editable">机（静）</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">顾</td>
                <td class="病 editable">病</td>
                <td class="病 editable">病 15:00-16:30</td>
                <td class="病 editable">病</td>
                <td class="病 editable">病 13:30-15:00</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">姚</td>
                <td class="病 editable">病</td>
                <td class="病 editable">病</td>
                <td class="病 editable">病</td>
                <td class="病 editable">病</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">辛</td>
                <td class="病 editable">病 13:30-15:00</td>
                <td class="病 editable">病</td>
                <td class="病 editable">病</td>
                <td class="病 editable">病 15:00-16:30</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">盼</td>
                <td class="病 editable">病 15:00-16:30</td>
                <td class="病 editable">病</td>
                <td class="病 editable">病 08:30-10:00</td>
                <td class="病 editable">病</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">皓</td>
                <td class="库 editable">库</td>
                <td class="库 editable">库 10:00-11:30</td>
                <td class="库 editable">库 15:00-16:30</td>
                <td class="库 editable">库</td>
                <td class="editable">-</td>
            </tr>
            <!-- 预约休息行 -->
            <tr class="rest-row">
                <td class="rest-label">预约休息</td>
                <td class="editable">-</td>
                <td class="editable">-</td>
                <td class="editable">-</td>
                <td class="editable">-</td>
                <td class="editable">-</td>
            </tr>
        </tbody></table>
        
        <div class="tip">
            💡 点击任意班次可以编辑，支持输入：门、库、静、病、机、休假、换班等<br>
            📝 预约休息行可填写临时休假或换班安排
        </div>
    </div>

    <!-- 确认对话框 -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <div class="modal-title">保存确认</div>
            <div class="modal-message">
                您确定要保存对<strong id="cellInfo"></strong>的修改吗？<br>
                新内容：<strong id="newContent"></strong>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="confirmSave()">✅ 保存</button>
                <button class="btn btn-secondary" onclick="cancelSave()">❌ 取消</button>
            </div>
        </div>
    </div>

    <script>
        // 获取所有可编辑单元格
        const editableCells = document.querySelectorAll('.editable');
        let currentlyEditing = null;
        let pendingEdit = null;
        
        // 自动应用样式
        function applyStyle(cell, text) {
            // 移除所有样式类
            cell.classList.remove('门', '库', '静', '病', '机', '休', '换', '门库混合');
            
            const content = text.toLowerCase();
            
            if (content.includes('休')) {
                cell.classList.add('休');
            } else if (content.includes('换')) {
                cell.classList.add('换');
            } else if (content.includes('门') && content.includes('库')) {
                cell.classList.add('门库混合');
            } else if (content.includes('门')) {
                cell.classList.add('门');
            } else if (content.includes('库')) {
                cell.classList.add('库');
            } else if (content.includes('静')) {
                cell.classList.add('静');
            } else if (content.includes('病')) {
                cell.classList.add('病');
            } else if (content.includes('机')) {
                cell.classList.add('机');
            }
        }
        
        // 获取单元格位置信息
        function getCellInfo(cell) {
            const row = cell.parentNode;
            const table = row.parentNode;
            const rowIndex = Array.from(table.children).indexOf(row);
            const cellIndex = Array.from(row.children).indexOf(cell);
            
            // 获取人员名称和日期
            const personName = row.children[0].textContent;
            const dateHeader = table.children[0].children[cellIndex].textContent;
            
            return `${personName} - ${dateHeader}`;
        }
        
        // 显示确认对话框
        function showConfirmDialog(cell, originalText, newText) {
            const cellInfo = getCellInfo(cell);
            document.getElementById('cellInfo').textContent = cellInfo;
            document.getElementById('newContent').textContent = newText || '-';
            document.getElementById('confirmModal').style.display = 'block';
            
            // 存储待处理的编辑信息
            pendingEdit = {
                cell: cell,
                originalText: originalText,
                newText: newText
            };
        }
        
        // 确认保存
        function confirmSave() {
            if (pendingEdit) {
                const { cell, newText } = pendingEdit;
                
                if (newText === '') {
                    cell.textContent = '-';
                } else {
                    cell.textContent = newText;
                }
                
                // 应用样式
                applyStyle(cell, newText);
                
                // 清理
                pendingEdit = null;
                currentlyEditing = null;
            }
            
            // 隐藏对话框
            document.getElementById('confirmModal').style.display = 'none';
        }
        
        // 取消保存
        function cancelSave() {
            if (pendingEdit) {
                const { cell, originalText } = pendingEdit;
                
                // 恢复原始内容
                cell.textContent = originalText;
                
                // 重新应用原有样式
                applyStyle(cell, originalText);
                
                // 清理
                pendingEdit = null;
                currentlyEditing = null;
            }
            
            // 隐藏对话框
            document.getElementById('confirmModal').style.display = 'none';
        }
        
        // 开始编辑
        function startEdit(cell) {
            if (currentlyEditing) return;
            
            currentlyEditing = cell;
            const originalText = cell.textContent.trim();
            
            // 创建输入框
            const input = document.createElement('textarea');
            input.className = 'edit-input';
            input.value = originalText === '-' ? '' : originalText;
            
            // 清空单元格并添加输入框
            cell.innerHTML = '';
            cell.appendChild(input);
            
            // 聚焦并选中文本
            input.focus();
            input.select();
            
            // 保存编辑（显示确认对话框）
            function saveEdit() {
                const newText = input.value.trim();
                
                // 如果内容没有变化，直接取消编辑
                if (newText === originalText || (newText === '' && originalText === '-')) {
                    cancelEdit();
                    return;
                }
                
                // 显示确认对话框
                showConfirmDialog(cell, originalText, newText);
            }
            
            // 取消编辑
            function cancelEdit() {
                currentlyEditing = null;
                cell.textContent = originalText;
                
                // 重新应用原有样式
                applyStyle(cell, originalText);
            }
            
            // 事件监听
            input.addEventListener('blur', saveEdit);
            input.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    saveEdit();
                } else if (e.key === 'Escape') {
                    e.preventDefault();
                    cancelEdit();
                }
            });
        }
        
        // 为所有可编辑单元格添加点击事件
        editableCells.forEach(cell => {
            cell.addEventListener('click', function(e) {
                e.preventDefault();
                startEdit(this);
            });
        });
        
        // 点击模态框背景关闭
        document.getElementById('confirmModal').addEventListener('click', function(e) {
            if (e.target === this) {
                cancelSave();
            }
        });
    </script>


</body></html>