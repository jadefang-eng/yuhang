<!DOCTYPE html><html lang="zh-CN"><head><meta name="x-poe-datastore-behavior" content="local_only"><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äººå‘˜æ’ç­è¡¨ - å¯ç¼–è¾‘ç‰ˆ</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            margin: 20px;
            background-color: #fafafa;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 25px;
            font-weight: normal;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        th, td {
            border: 1px solid #e0e0e0;
            padding: 10px 8px;
            text-align: center;
            white-space: nowrap;
            position: relative;
        }
        th {
            background-color: #f8f9fa;
            color: #333;
            font-weight: bold;
            font-size: 15px;
        }
        .name {
            background-color: #e8eaf6;
            color: #3f51b5;
            font-weight: bold;
            width: 70px;
            font-size: 15px;
            letter-spacing: 1px;
        }
        
        /* å¯ç¼–è¾‘å•å…ƒæ ¼æ ·å¼ */
        .editable {
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .editable:hover {
            background-color: #f0f9ff !important;
            box-shadow: inset 0 0 0 2px #3b82f6;
        }
        
        /* ç¼–è¾‘è¾“å…¥æ¡†æ ·å¼ */
        .edit-input {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
            text-align: center;
            font-size: 14px;
            font-family: inherit;
            box-shadow: inset 0 0 0 2px #3b82f6;
            border-radius: 4px;
            outline: none;
            position: absolute;
            top: 0;
            left: 0;
            padding: 10px 8px;
            box-sizing: border-box;
            resize: none;
        }
        
        /* ç®€æ´çš„ç­æ¬¡é¢œè‰² */
        .é—¨ { background-color: #e3f2fd; color: #1976d2; }
        .åº“ { background-color: #f5f5f5; color: #424242; }
        .é™ { background-color: #e8eaf6; color: #5e35b1; }
        .ç—… { background-color: #fff3e0; color: #f57c00; }
        .æœº { background-color: #f1f8e9; color: #689f38; }
        .é—¨åº“æ··åˆ { background-color: #e3f2fd; color: #1976d2; }
        .ä¼‘ { background-color: #fef3c7; color: #d97706; }
        .æ¢ { background-color: #f3e8ff; color: #7c3aed; }
        
        /* é¢„çº¦ä¼‘æ¯è¡Œæ ·å¼ */
        .rest-row {
            background-color: #f9f9f9;
            border-top: 2px solid #ddd;
        }
        .rest-label {
            background-color: #f0f0f0;
            color: #666;
            font-weight: bold;
            font-size: 13px;
            font-style: italic;
        }
        
        /* ç¡®è®¤å¯¹è¯æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            text-align: center;
            min-width: 300px;
        }
        .modal-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }
        .modal-message {
            font-size: 14px;
            margin-bottom: 25px;
            color: #666;
            line-height: 1.4;
        }
        .modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-family: inherit;
            transition: background-color 0.3s;
        }
        .btn-primary {
            background-color: #4CAF50;
            color: white;
        }
        .btn-primary:hover {
            background-color: #45a049;
        }
        .btn-secondary {
            background-color: #f44336;
            color: white;
        }
        .btn-secondary:hover {
            background-color: #da190b;
        }
        
        /* æç¤ºä¿¡æ¯ */
        .tip {
            text-align: center;
            color: #666;
            font-size: 12px;
            margin-top: 15px;
            font-style: italic;
        }
        
        @media (max-width: 768px) {
            .container { padding: 15px; margin: 10px; }
            th, td { padding: 8px 6px; font-size: 13px; }
            .name { font-size: 14px; }
            .edit-input { font-size: 13px; padding: 8px 6px; }
            .modal-content { 
                min-width: 280px; 
                padding: 20px; 
                margin: 20px;
            }
            .modal-buttons { 
                flex-direction: column; 
                gap: 10px;
            }
        }
    </style>
<script src="https://puc.poecdn.net/authenticated_preview_page/syncedState.bd4eeeb8e8e02052ee92.js"></script></head>
<body>
    <div class="container">
        <h1>äººå‘˜æ’ç­è¡¨ - å¯ç¼–è¾‘ç‰ˆ</h1>
        
        <table id="scheduleTable">
            <tbody><tr>
                <th>äººå‘˜</th>
                <th>9.23</th>
                <th>9.24</th>
                <th>9.25</th>
                <th>9.26</th>
                <th>å‘¨æœ«</th>
            </tr>
            <tr>
                <td class="name">å€ª</td>
                <td class="é—¨ editable">é—¨</td>
                <td class="é—¨ editable">é—¨ä¸Š/é—¨</td>
                <td class="é—¨ editable">é—¨æ‹–</td>
                <td class="é—¨ editable">é—¨ä¸­</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">ä¸½</td>
                <td class="é—¨ editable">é—¨ä¸­</td>
                <td class="é—¨ editable">é—¨</td>
                <td class="é—¨ editable">é—¨/é—¨ä¸‹</td>
                <td class="é—¨ editable">é—¨æ‹–</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">æ–¹</td>
                <td class="é—¨ editable">é—¨æ‹–</td>
                <td class="é—¨ editable">é—¨ä¸­</td>
                <td class="é—¨ editable">é—¨</td>
                <td class="é—¨ editable">é—¨ä¸Š/é—¨</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">å¦</td>
                <td class="é—¨ editable">é—¨/é—¨ä¸‹</td>
                <td class="é—¨ editable">é—¨æ‹–</td>
                <td class="é—¨ editable">é—¨ä¸­</td>
                <td class="é—¨ editable">é—¨</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">ç§¦</td>
                <td class="é—¨åº“æ··åˆ editable">é—¨ä¸Š/åº“</td>
                <td class="é—¨åº“æ··åˆ editable">åº“/é—¨ä¸‹</td>
                <td class="é—¨åº“æ··åˆ editable">é—¨ä¸Š/åº“</td>
                <td class="é—¨åº“æ··åˆ editable">åº“/é—¨ä¸‹</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">åº†</td>
                <td class="åº“ editable">åº“</td>
                <td class="åº“ editable">åº“ 08:30-10:00</td>
                <td class="åº“ editable">åº“ 13:30-15:00</td>
                <td class="åº“ editable">åº“</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">ç‘¾</td>
                <td class="æœº editable">æœºï¼ˆé™ï¼‰</td>
                <td class="é™ editable">é™ 13:30-15:00</td>
                <td class="é™ editable">é™</td>
                <td class="é™ editable">é™ 08:30-10:00</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">å…¨</td>
                <td class="é™ editable">é™</td>
                <td class="æœº editable">æœºï¼ˆé™ï¼‰</td>
                <td class="é™ editable">é™ 10:00-11:30</td>
                <td class="é™ editable">é™</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">è£</td>
                <td class="é™ editable">é™ 08:30-10:00</td>
                <td class="é™ editable">é™</td>
                <td class="æœº editable">æœºï¼ˆé™ï¼‰</td>
                <td class="é™ editable">é™ 10:00-11:30</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">æ–¯</td>
                <td class="é™ editable">é™ 10:00-11:30</td>
                <td class="é™ editable">é™</td>
                <td class="é™ editable">é™</td>
                <td class="æœº editable">æœºï¼ˆé™ï¼‰</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">é¡¾</td>
                <td class="ç—… editable">ç—…</td>
                <td class="ç—… editable">ç—… 15:00-16:30</td>
                <td class="ç—… editable">ç—…</td>
                <td class="ç—… editable">ç—… 13:30-15:00</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">å§š</td>
                <td class="ç—… editable">ç—…</td>
                <td class="ç—… editable">ç—…</td>
                <td class="ç—… editable">ç—…</td>
                <td class="ç—… editable">ç—…</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">è¾›</td>
                <td class="ç—… editable">ç—… 13:30-15:00</td>
                <td class="ç—… editable">ç—…</td>
                <td class="ç—… editable">ç—…</td>
                <td class="ç—… editable">ç—… 15:00-16:30</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">ç›¼</td>
                <td class="ç—… editable">ç—… 15:00-16:30</td>
                <td class="ç—… editable">ç—…</td>
                <td class="ç—… editable">ç—… 08:30-10:00</td>
                <td class="ç—… editable">ç—…</td>
                <td class="editable">-</td>
            </tr>
            <tr>
                <td class="name">çš“</td>
                <td class="åº“ editable">åº“</td>
                <td class="åº“ editable">åº“ 10:00-11:30</td>
                <td class="åº“ editable">åº“ 15:00-16:30</td>
                <td class="åº“ editable">åº“</td>
                <td class="editable">-</td>
            </tr>
            <!-- é¢„çº¦ä¼‘æ¯è¡Œ -->
            <tr class="rest-row">
                <td class="rest-label">é¢„çº¦ä¼‘æ¯</td>
                <td class="editable">-</td>
                <td class="editable">-</td>
                <td class="editable">-</td>
                <td class="editable">-</td>
                <td class="editable">-</td>
            </tr>
        </tbody></table>
        
        <div class="tip">
            ğŸ’¡ ç‚¹å‡»ä»»æ„ç­æ¬¡å¯ä»¥ç¼–è¾‘ï¼Œæ”¯æŒè¾“å…¥ï¼šé—¨ã€åº“ã€é™ã€ç—…ã€æœºã€ä¼‘å‡ã€æ¢ç­ç­‰<br>
            ğŸ“ é¢„çº¦ä¼‘æ¯è¡Œå¯å¡«å†™ä¸´æ—¶ä¼‘å‡æˆ–æ¢ç­å®‰æ’
        </div>
    </div>

    <!-- ç¡®è®¤å¯¹è¯æ¡† -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <div class="modal-title">ä¿å­˜ç¡®è®¤</div>
            <div class="modal-message">
                æ‚¨ç¡®å®šè¦ä¿å­˜å¯¹<strong id="cellInfo"></strong>çš„ä¿®æ”¹å—ï¼Ÿ<br>
                æ–°å†…å®¹ï¼š<strong id="newContent"></strong>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="confirmSave()">âœ… ä¿å­˜</button>
                <button class="btn btn-secondary" onclick="cancelSave()">âŒ å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <script>
        // è·å–æ‰€æœ‰å¯ç¼–è¾‘å•å…ƒæ ¼
        const editableCells = document.querySelectorAll('.editable');
        let currentlyEditing = null;
        let pendingEdit = null;
        
        // è‡ªåŠ¨åº”ç”¨æ ·å¼
        function applyStyle(cell, text) {
            // ç§»é™¤æ‰€æœ‰æ ·å¼ç±»
            cell.classList.remove('é—¨', 'åº“', 'é™', 'ç—…', 'æœº', 'ä¼‘', 'æ¢', 'é—¨åº“æ··åˆ');
            
            const content = text.toLowerCase();
            
            if (content.includes('ä¼‘')) {
                cell.classList.add('ä¼‘');
            } else if (content.includes('æ¢')) {
                cell.classList.add('æ¢');
            } else if (content.includes('é—¨') && content.includes('åº“')) {
                cell.classList.add('é—¨åº“æ··åˆ');
            } else if (content.includes('é—¨')) {
                cell.classList.add('é—¨');
            } else if (content.includes('åº“')) {
                cell.classList.add('åº“');
            } else if (content.includes('é™')) {
                cell.classList.add('é™');
            } else if (content.includes('ç—…')) {
                cell.classList.add('ç—…');
            } else if (content.includes('æœº')) {
                cell.classList.add('æœº');
            }
        }
        
        // è·å–å•å…ƒæ ¼ä½ç½®ä¿¡æ¯
        function getCellInfo(cell) {
            const row = cell.parentNode;
            const table = row.parentNode;
            const rowIndex = Array.from(table.children).indexOf(row);
            const cellIndex = Array.from(row.children).indexOf(cell);
            
            // è·å–äººå‘˜åç§°å’Œæ—¥æœŸ
            const personName = row.children[0].textContent;
            const dateHeader = table.children[0].children[cellIndex].textContent;
            
            return `${personName} - ${dateHeader}`;
        }
        
        // æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†
        function showConfirmDialog(cell, originalText, newText) {
            const cellInfo = getCellInfo(cell);
            document.getElementById('cellInfo').textContent = cellInfo;
            document.getElementById('newContent').textContent = newText || '-';
            document.getElementById('confirmModal').style.display = 'block';
            
            // å­˜å‚¨å¾…å¤„ç†çš„ç¼–è¾‘ä¿¡æ¯
            pendingEdit = {
                cell: cell,
                originalText: originalText,
                newText: newText
            };
        }
        
        // ç¡®è®¤ä¿å­˜
        function confirmSave() {
            if (pendingEdit) {
                const { cell, newText } = pendingEdit;
                
                if (newText === '') {
                    cell.textContent = '-';
                } else {
                    cell.textContent = newText;
                }
                
                // åº”ç”¨æ ·å¼
                applyStyle(cell, newText);
                
                // æ¸…ç†
                pendingEdit = null;
                currentlyEditing = null;
            }
            
            // éšè—å¯¹è¯æ¡†
            document.getElementById('confirmModal').style.display = 'none';
        }
        
        // å–æ¶ˆä¿å­˜
        function cancelSave() {
            if (pendingEdit) {
                const { cell, originalText } = pendingEdit;
                
                // æ¢å¤åŸå§‹å†…å®¹
                cell.textContent = originalText;
                
                // é‡æ–°åº”ç”¨åŸæœ‰æ ·å¼
                applyStyle(cell, originalText);
                
                // æ¸…ç†
                pendingEdit = null;
                currentlyEditing = null;
            }
            
            // éšè—å¯¹è¯æ¡†
            document.getElementById('confirmModal').style.display = 'none';
        }
        
        // å¼€å§‹ç¼–è¾‘
        function startEdit(cell) {
            if (currentlyEditing) return;
            
            currentlyEditing = cell;
            const originalText = cell.textContent.trim();
            
            // åˆ›å»ºè¾“å…¥æ¡†
            const input = document.createElement('textarea');
            input.className = 'edit-input';
            input.value = originalText === '-' ? '' : originalText;
            
            // æ¸…ç©ºå•å…ƒæ ¼å¹¶æ·»åŠ è¾“å…¥æ¡†
            cell.innerHTML = '';
            cell.appendChild(input);
            
            // èšç„¦å¹¶é€‰ä¸­æ–‡æœ¬
            input.focus();
            input.select();
            
            // ä¿å­˜ç¼–è¾‘ï¼ˆæ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†ï¼‰
            function saveEdit() {
                const newText = input.value.trim();
                
                // å¦‚æœå†…å®¹æ²¡æœ‰å˜åŒ–ï¼Œç›´æ¥å–æ¶ˆç¼–è¾‘
                if (newText === originalText || (newText === '' && originalText === '-')) {
                    cancelEdit();
                    return;
                }
                
                // æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†
                showConfirmDialog(cell, originalText, newText);
            }
            
            // å–æ¶ˆç¼–è¾‘
            function cancelEdit() {
                currentlyEditing = null;
                cell.textContent = originalText;
                
                // é‡æ–°åº”ç”¨åŸæœ‰æ ·å¼
                applyStyle(cell, originalText);
            }
            
            // äº‹ä»¶ç›‘å¬
            input.addEventListener('blur', saveEdit);
            input.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    saveEdit();
                } else if (e.key === 'Escape') {
                    e.preventDefault();
                    cancelEdit();
                }
            });
        }
        
        // ä¸ºæ‰€æœ‰å¯ç¼–è¾‘å•å…ƒæ ¼æ·»åŠ ç‚¹å‡»äº‹ä»¶
        editableCells.forEach(cell => {
            cell.addEventListener('click', function(e) {
                e.preventDefault();
                startEdit(this);
            });
        });
        
        // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
        document.getElementById('confirmModal').addEventListener('click', function(e) {
            if (e.target === this) {
                cancelSave();
            }
        });
    </script>


</body></html>